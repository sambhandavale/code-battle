import mongoose from "mongoose";
const MONGO_URI = process.env.MONGO_URI || "mongodb://localhost:27017/codeduel";
if (!global.mongoose) {
  global.mongoose = { conn: null, promise: null };
}
async function connectDB() {
  if (global.mongoose.conn) return global.mongoose.conn;
  if (!global.mongoose.promise) {
    global.mongoose.promise = mongoose.connect(MONGO_URI).then((mongoose2) => mongoose2);
  }
  global.mongoose.conn = await global.mongoose.promise;
  return global.mongoose.conn;
}
export {
  connectDB
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vc3JjL2RiLnRzIl0sCiAgInNvdXJjZXNDb250ZW50IjogWyJpbXBvcnQgbW9uZ29vc2UgZnJvbSAnbW9uZ29vc2UnO1xyXG5cclxuY29uc3QgTU9OR09fVVJJID0gcHJvY2Vzcy5lbnYuTU9OR09fVVJJIHx8ICdtb25nb2RiOi8vbG9jYWxob3N0OjI3MDE3L2NvZGVkdWVsJztcclxuXHJcbmlmICghZ2xvYmFsLm1vbmdvb3NlKSB7XHJcbiAgZ2xvYmFsLm1vbmdvb3NlID0geyBjb25uOiBudWxsLCBwcm9taXNlOiBudWxsIH07XHJcbn1cclxuXHJcbmV4cG9ydCBhc3luYyBmdW5jdGlvbiBjb25uZWN0REIoKSB7XHJcbiAgaWYgKGdsb2JhbC5tb25nb29zZS5jb25uKSByZXR1cm4gZ2xvYmFsLm1vbmdvb3NlLmNvbm47XHJcblxyXG4gIGlmICghZ2xvYmFsLm1vbmdvb3NlLnByb21pc2UpIHtcclxuICAgIGdsb2JhbC5tb25nb29zZS5wcm9taXNlID0gbW9uZ29vc2UuY29ubmVjdChNT05HT19VUkkpLnRoZW4oKG1vbmdvb3NlKSA9PiBtb25nb29zZSk7XHJcbiAgfVxyXG4gIFxyXG4gIGdsb2JhbC5tb25nb29zZS5jb25uID0gYXdhaXQgZ2xvYmFsLm1vbmdvb3NlLnByb21pc2U7XHJcbiAgcmV0dXJuIGdsb2JhbC5tb25nb29zZS5jb25uO1xyXG59XHJcbiBcclxuZGVjbGFyZSBnbG9iYWwge1xyXG4gIHZhciBtb25nb29zZTogeyBjb25uOiBhbnk7IHByb21pc2U6IGFueSB9O1xyXG59Il0sCiAgIm1hcHBpbmdzIjogIkFBQUEsT0FBTyxjQUFjO0FBRXJCLE1BQU0sWUFBWSxRQUFRLElBQUksYUFBYTtBQUUzQyxJQUFJLENBQUMsT0FBTyxVQUFVO0FBQ3BCLFNBQU8sV0FBVyxFQUFFLE1BQU0sTUFBTSxTQUFTLEtBQUs7QUFDaEQ7QUFFQSxlQUFzQixZQUFZO0FBQ2hDLE1BQUksT0FBTyxTQUFTLEtBQU0sUUFBTyxPQUFPLFNBQVM7QUFFakQsTUFBSSxDQUFDLE9BQU8sU0FBUyxTQUFTO0FBQzVCLFdBQU8sU0FBUyxVQUFVLFNBQVMsUUFBUSxTQUFTLEVBQUUsS0FBSyxDQUFDQSxjQUFhQSxTQUFRO0FBQUEsRUFDbkY7QUFFQSxTQUFPLFNBQVMsT0FBTyxNQUFNLE9BQU8sU0FBUztBQUM3QyxTQUFPLE9BQU8sU0FBUztBQUN6QjsiLAogICJuYW1lcyI6IFsibW9uZ29vc2UiXQp9Cg==
