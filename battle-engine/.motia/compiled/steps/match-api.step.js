import { connectDB } from "../src/db.js";
import { MatchModel } from "../src/models/Match.js";
import Question from "../src/models/Question.js";
const config = {
  name: "MatchAPI",
  type: "api",
  path: "/match/:action",
  method: "POST",
  emits: ["player.joined", "run.code", "analyze.code"],
  flows: ["CodeDuelFlow"]
};
const handler = async (req, context) => {
  const { emit, logger, streams } = context;
  await connectDB();
  try {
    let bodyData = req.body;
    if (typeof bodyData === "string") {
      try {
        bodyData = JSON.parse(bodyData);
      } catch (e) {
        logger.error("JSON Parse Error:", e);
        return { status: 400, body: { error: "Invalid JSON body" } };
      }
    }
    bodyData = bodyData || {};
    const { playerId, matchId, code, language, time, problemTitle } = bodyData;
    const action = req.params?.action || req.pathParams?.action;
    logger.info(`API Hit: ${action}`, {
      receivedCode: !!code,
      bodyType: typeof req.body
    });
    if (action === "create") {
      const newMatchId = matchId || `match_${Date.now()}`;
      let validDuration = 5;
      if (time && [5, 10, 20].includes(time)) {
        validDuration = time;
      }
      const durationMs = validDuration * 60 * 1e3;
      const count = await Question.countDocuments({ time: validDuration });
      if (count === 0) {
        return { status: 500, body: { error: `No questions found for ${validDuration} mins.` } };
      }
      const random = Math.floor(Math.random() * count);
      const randomQuestion = await Question.findOne({ time: validDuration }).skip(random);
      if (!randomQuestion) {
        return { status: 500, body: { error: "Error fetching question." } };
      }
      logger.info(`Creating Match ${newMatchId} with problem: ${randomQuestion.title}`);
      await MatchModel.create({
        matchId: newMatchId,
        players: [playerId],
        status: "WAITING",
        problemId: randomQuestion._id.toString(),
        duration: durationMs
      });
      return {
        status: 200,
        body: {
          matchId: newMatchId,
          msg: "Match Created",
          durationMinutes: validDuration,
          problemTitle: randomQuestion.title
        }
      };
    }
    if (action === "join") {
      let game = await MatchModel.findOneAndUpdate(
        { matchId, status: "WAITING" },
        { $addToSet: { players: playerId } },
        { new: true }
      );
      if (!game) {
        game = await MatchModel.findOne({ matchId });
        if (!game) {
          return { status: 404, body: { error: "Match not found" } };
        }
        const isAlreadyIn = game.players.includes(playerId);
        if (!isAlreadyIn) {
          return { status: 400, body: { error: `Cannot join. Match is ${game.status}` } };
        }
      }
      const problem = await Question.findById(game.problemId);
      logger.info(`DB: Player ${playerId} active in ${matchId}`);
      await emit({ topic: "player.joined", data: { matchId, playerId } });
      if (streams?.match) {
        await streams.match.set(matchId, "message", {
          type: "PLAYER_JOINED",
          playerId,
          players: game.players
        });
      }
      return {
        status: 200,
        body: {
          msg: "Joined",
          state: game,
          durationMs: game.duration,
          problem: { title: problem?.title, description: problem?.description }
        }
      };
    }
    if (action === "submit" || action === "run") {
      const requestType = req.body?.type || (action === "run" ? "RUN_TESTS" : "SUBMIT_SOLUTION");
      const match = await MatchModel.findOne({ matchId });
      if (!match) return { status: 404, body: { error: "Match not found" } };
      if (requestType === "SUBMIT_SOLUTION" && match.status !== "RACING") {
        return { status: 400, body: { error: `Cannot submit. Match is ${match.status}` } };
      }
      const jobData = {
        matchId,
        playerId,
        code,
        action: requestType,
        // @ts-ignore
        language: language || "python",
        version: "3.10.0"
      };
      logger.info(`API: Queueing ${requestType} for ${playerId}`);
      await emit({ topic: "run.code", data: jobData });
      return { status: 200, body: { msg: "Code queued" } };
    }
    if (action === "analyze") {
      const { code: code2, language: language2, problemTitle: problemTitle2 } = req.body;
      if (!code2) {
        return { status: 400, body: { error: "No code provided for analysis." } };
      }
      await emit({
        topic: "analyze.code",
        data: {
          matchId,
          playerId,
          code: code2,
          language: language2 || "python",
          problemTitle: problemTitle2 || "Unknown Problem"
        }
      });
      return {
        status: 200,
        body: { msg: "Analysis started. Watch the stream for results." }
      };
    }
    return { status: 400, body: { error: "Invalid Action" } };
  } catch (error) {
    logger.error("API Error", error);
    return { status: 500, body: { error: error.message } };
  }
};
export {
  config,
  handler
};
//# sourceMappingURL=data:application/json;base64,ewogICJ2ZXJzaW9uIjogMywKICAic291cmNlcyI6IFsiLi4vLi4vLi4vc3RlcHMvbWF0Y2gtYXBpLnN0ZXAudHMiXSwKICAic291cmNlc0NvbnRlbnQiOiBbImltcG9ydCB7IFN0ZXBDb25maWcgfSBmcm9tICdtb3RpYSc7XHJcbmltcG9ydCB7IGNvbm5lY3REQiB9IGZyb20gJy4uL3NyYy9kYic7XHJcbmltcG9ydCB7IE1hdGNoTW9kZWwgfSBmcm9tICcuLi9zcmMvbW9kZWxzL01hdGNoJztcclxuaW1wb3J0IHsgUnVubmVyUmVxdWVzdCB9IGZyb20gJy4uL3NyYy90eXBlcyc7XHJcbmltcG9ydCBRdWVzdGlvbiBmcm9tICcuLi9zcmMvbW9kZWxzL1F1ZXN0aW9uJztcclxuXHJcbmV4cG9ydCBjb25zdCBjb25maWc6IFN0ZXBDb25maWcgPSB7XHJcbiAgbmFtZTogJ01hdGNoQVBJJyxcclxuICB0eXBlOiAnYXBpJyxcclxuICBwYXRoOiAnL21hdGNoLzphY3Rpb24nLFxyXG4gIG1ldGhvZDogJ1BPU1QnLFxyXG4gIGVtaXRzOiBbJ3BsYXllci5qb2luZWQnLCAncnVuLmNvZGUnLCAnYW5hbHl6ZS5jb2RlJ10sXHJcbiAgZmxvd3M6IFsnQ29kZUR1ZWxGbG93J11cclxufTtcclxuXHJcbmV4cG9ydCBjb25zdCBoYW5kbGVyID0gYXN5bmMgKHJlcTogYW55LCBjb250ZXh0OiBhbnkpID0+IHtcclxuICBjb25zdCB7IGVtaXQsIGxvZ2dlciwgc3RyZWFtcyB9ID0gY29udGV4dDtcclxuICBhd2FpdCBjb25uZWN0REIoKTtcclxuXHJcbiAgdHJ5IHtcclxuICAgIC8vIGNvbnN0IGFjdGlvbiA9IHJlcS5wYXJhbXM/LmFjdGlvbiB8fCByZXEucGF0aFBhcmFtcz8uYWN0aW9uO1xyXG4gICAgLy8gY29uc3QgeyBwbGF5ZXJJZCwgbWF0Y2hJZCwgY29kZSwgbGFuZ3VhZ2UsIHRpbWUgfSA9IHJlcS5ib2R5IHx8IHt9O1xyXG5cclxuICAgIGxldCBib2R5RGF0YSA9IHJlcS5ib2R5O1xyXG4gICAgXHJcbiAgICBpZiAodHlwZW9mIGJvZHlEYXRhID09PSAnc3RyaW5nJykge1xyXG4gICAgICAgIHRyeSB7XHJcbiAgICAgICAgICAgIGJvZHlEYXRhID0gSlNPTi5wYXJzZShib2R5RGF0YSk7XHJcbiAgICAgICAgfSBjYXRjaCAoZSkge1xyXG4gICAgICAgICAgICBsb2dnZXIuZXJyb3IoXCJKU09OIFBhcnNlIEVycm9yOlwiLCBlKTtcclxuICAgICAgICAgICAgcmV0dXJuIHsgc3RhdHVzOiA0MDAsIGJvZHk6IHsgZXJyb3I6IFwiSW52YWxpZCBKU09OIGJvZHlcIiB9IH07XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG4gICAgXHJcbiAgICAvLyBFbnN1cmUgaXQncyBhbiBvYmplY3QgKGhhbmRsZXMgbnVsbC91bmRlZmluZWQpXHJcbiAgICBib2R5RGF0YSA9IGJvZHlEYXRhIHx8IHt9OyBcclxuXHJcbiAgICAvLyBOb3cgdXNlIGJvZHlEYXRhIGluc3RlYWQgb2YgcmVxLmJvZHkgZm9yIGRlc3RydWN0dXJpbmdcclxuICAgIGNvbnN0IHsgcGxheWVySWQsIG1hdGNoSWQsIGNvZGUsIGxhbmd1YWdlLCB0aW1lLCBwcm9ibGVtVGl0bGUgfSA9IGJvZHlEYXRhO1xyXG4gICAgLy8gLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tLS0tXHJcblxyXG4gICAgY29uc3QgYWN0aW9uID0gcmVxLnBhcmFtcz8uYWN0aW9uIHx8IHJlcS5wYXRoUGFyYW1zPy5hY3Rpb247XHJcblxyXG4gICAgLy8gRGVidWdnaW5nOiBMb2cgd2hhdCB0aGUgc2VydmVyIGFjdHVhbGx5IHNlZXNcclxuICAgIGxvZ2dlci5pbmZvKGBBUEkgSGl0OiAke2FjdGlvbn1gLCB7IFxyXG4gICAgICAgIHJlY2VpdmVkQ29kZTogISFjb2RlLCBcclxuICAgICAgICBib2R5VHlwZTogdHlwZW9mIHJlcS5ib2R5IFxyXG4gICAgfSk7XHJcblxyXG4gICAgaWYgKGFjdGlvbiA9PT0gJ2NyZWF0ZScpIHtcclxuICAgICAgICBjb25zdCBuZXdNYXRjaElkID0gbWF0Y2hJZCB8fCBgbWF0Y2hfJHtEYXRlLm5vdygpfWA7XHJcbiAgICAgICAgXHJcbiAgICAgICAgbGV0IHZhbGlkRHVyYXRpb24gPSA1O1xyXG4gICAgICAgIGlmICh0aW1lICYmIFs1LCAxMCwgMjBdLmluY2x1ZGVzKHRpbWUpKSB7XHJcbiAgICAgICAgICAgIHZhbGlkRHVyYXRpb24gPSB0aW1lO1xyXG4gICAgICAgIH1cclxuICAgICAgICBjb25zdCBkdXJhdGlvbk1zID0gdmFsaWREdXJhdGlvbiAqIDYwICogMTAwMDtcclxuXHJcbiAgICAgICAgY29uc3QgY291bnQgPSBhd2FpdCBRdWVzdGlvbi5jb3VudERvY3VtZW50cyh7IHRpbWU6IHZhbGlkRHVyYXRpb24gfSk7XHJcbiAgICAgICAgaWYgKGNvdW50ID09PSAwKSB7XHJcbiAgICAgICAgICAgIHJldHVybiB7IHN0YXR1czogNTAwLCBib2R5OiB7IGVycm9yOiBgTm8gcXVlc3Rpb25zIGZvdW5kIGZvciAke3ZhbGlkRHVyYXRpb259IG1pbnMuYCB9IH07XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCByYW5kb20gPSBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiBjb3VudCk7XHJcbiAgICAgICAgY29uc3QgcmFuZG9tUXVlc3Rpb24gPSBhd2FpdCBRdWVzdGlvbi5maW5kT25lKHsgdGltZTogdmFsaWREdXJhdGlvbiB9KS5za2lwKHJhbmRvbSk7XHJcblxyXG4gICAgICAgIGlmICghcmFuZG9tUXVlc3Rpb24pIHtcclxuICAgICAgICAgICAgcmV0dXJuIHsgc3RhdHVzOiA1MDAsIGJvZHk6IHsgZXJyb3I6IFwiRXJyb3IgZmV0Y2hpbmcgcXVlc3Rpb24uXCIgfSB9O1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgbG9nZ2VyLmluZm8oYENyZWF0aW5nIE1hdGNoICR7bmV3TWF0Y2hJZH0gd2l0aCBwcm9ibGVtOiAke3JhbmRvbVF1ZXN0aW9uLnRpdGxlfWApO1xyXG5cclxuICAgICAgICBhd2FpdCBNYXRjaE1vZGVsLmNyZWF0ZSh7XHJcbiAgICAgICAgICAgIG1hdGNoSWQ6IG5ld01hdGNoSWQsXHJcbiAgICAgICAgICAgIHBsYXllcnM6IFtwbGF5ZXJJZF0sXHJcbiAgICAgICAgICAgIHN0YXR1czogJ1dBSVRJTkcnLFxyXG4gICAgICAgICAgICBwcm9ibGVtSWQ6IHJhbmRvbVF1ZXN0aW9uLl9pZC50b1N0cmluZygpLFxyXG4gICAgICAgICAgICBkdXJhdGlvbjogZHVyYXRpb25Nc1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIFxyXG4gICAgICAgIHJldHVybiB7IFxyXG4gICAgICAgICAgICBzdGF0dXM6IDIwMCwgXHJcbiAgICAgICAgICAgIGJvZHk6IHsgXHJcbiAgICAgICAgICAgICAgICBtYXRjaElkOiBuZXdNYXRjaElkLCBcclxuICAgICAgICAgICAgICAgIG1zZzogXCJNYXRjaCBDcmVhdGVkXCIsIFxyXG4gICAgICAgICAgICAgICAgZHVyYXRpb25NaW51dGVzOiB2YWxpZER1cmF0aW9uLFxyXG4gICAgICAgICAgICAgICAgcHJvYmxlbVRpdGxlOiByYW5kb21RdWVzdGlvbi50aXRsZSBcclxuICAgICAgICAgICAgfSBcclxuICAgICAgICB9O1xyXG4gICAgfVxyXG5cclxuICAgIGlmIChhY3Rpb24gPT09ICdqb2luJykge1xyXG4gICAgICAgIGxldCBnYW1lID0gYXdhaXQgTWF0Y2hNb2RlbC5maW5kT25lQW5kVXBkYXRlKFxyXG4gICAgICAgICAgICB7IG1hdGNoSWQsIHN0YXR1czogJ1dBSVRJTkcnIH0sXHJcbiAgICAgICAgICAgIHsgJGFkZFRvU2V0OiB7IHBsYXllcnM6IHBsYXllcklkIH0gfSxcclxuICAgICAgICAgICAgeyBuZXc6IHRydWUgfSBcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICBpZiAoIWdhbWUpIHtcclxuICAgICAgICAgICAgZ2FtZSA9IGF3YWl0IE1hdGNoTW9kZWwuZmluZE9uZSh7IG1hdGNoSWQgfSk7XHJcbiAgICAgICAgICAgIFxyXG4gICAgICAgICAgICBpZiAoIWdhbWUpIHtcclxuICAgICAgICAgICAgICAgIHJldHVybiB7IHN0YXR1czogNDA0LCBib2R5OiB7IGVycm9yOiBcIk1hdGNoIG5vdCBmb3VuZFwiIH0gfTtcclxuICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgY29uc3QgaXNBbHJlYWR5SW4gPSBnYW1lLnBsYXllcnMuaW5jbHVkZXMocGxheWVySWQpO1xyXG4gICAgICAgICAgICBcclxuICAgICAgICAgICAgaWYgKCFpc0FscmVhZHlJbikge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHsgc3RhdHVzOiA0MDAsIGJvZHk6IHsgZXJyb3I6IGBDYW5ub3Qgam9pbi4gTWF0Y2ggaXMgJHtnYW1lLnN0YXR1c31gIH0gfTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgY29uc3QgcHJvYmxlbSA9IGF3YWl0IFF1ZXN0aW9uLmZpbmRCeUlkKGdhbWUucHJvYmxlbUlkKTtcclxuICAgICAgICBsb2dnZXIuaW5mbyhgREI6IFBsYXllciAke3BsYXllcklkfSBhY3RpdmUgaW4gJHttYXRjaElkfWApO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGF3YWl0IGVtaXQoeyB0b3BpYzogJ3BsYXllci5qb2luZWQnLCBkYXRhOiB7IG1hdGNoSWQsIHBsYXllcklkIH0gfSk7XHJcblxyXG4gICAgICAgIGlmIChzdHJlYW1zPy5tYXRjaCkge1xyXG4gICAgICAgICAgICBhd2FpdCBzdHJlYW1zLm1hdGNoLnNldChtYXRjaElkLCAnbWVzc2FnZScsIHsgXHJcbiAgICAgICAgICAgICAgICB0eXBlOiAnUExBWUVSX0pPSU5FRCcsIFxyXG4gICAgICAgICAgICAgICAgcGxheWVySWQ6IHBsYXllcklkLFxyXG4gICAgICAgICAgICAgICAgcGxheWVyczogZ2FtZS5wbGF5ZXJzXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBcclxuICAgICAgICByZXR1cm4geyBcclxuICAgICAgICAgICAgc3RhdHVzOiAyMDAsIFxyXG4gICAgICAgICAgICBib2R5OiB7IFxyXG4gICAgICAgICAgICAgICAgbXNnOiBcIkpvaW5lZFwiLCBcclxuICAgICAgICAgICAgICAgIHN0YXRlOiBnYW1lLFxyXG4gICAgICAgICAgICAgICAgZHVyYXRpb25NczogZ2FtZS5kdXJhdGlvbiwgXHJcbiAgICAgICAgICAgICAgICBwcm9ibGVtOiB7IHRpdGxlOiBwcm9ibGVtPy50aXRsZSwgZGVzY3JpcHRpb246IHByb2JsZW0/LmRlc2NyaXB0aW9uIH0gXHJcbiAgICAgICAgICAgIH0gXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoYWN0aW9uID09PSAnc3VibWl0JyB8fCBhY3Rpb24gPT09ICdydW4nKSB7XHJcbiAgICAgICAgY29uc3QgcmVxdWVzdFR5cGUgPSByZXEuYm9keT8udHlwZSB8fCAoYWN0aW9uID09PSAncnVuJyA/ICdSVU5fVEVTVFMnIDogJ1NVQk1JVF9TT0xVVElPTicpO1xyXG4gICAgICAgIFxyXG4gICAgICAgIGNvbnN0IG1hdGNoID0gYXdhaXQgTWF0Y2hNb2RlbC5maW5kT25lKHsgbWF0Y2hJZCB9KTtcclxuICAgICAgICBpZiAoIW1hdGNoKSByZXR1cm4geyBzdGF0dXM6IDQwNCwgYm9keTogeyBlcnJvcjogXCJNYXRjaCBub3QgZm91bmRcIiB9IH07XHJcblxyXG4gICAgICAgIGlmIChyZXF1ZXN0VHlwZSA9PT0gJ1NVQk1JVF9TT0xVVElPTicgJiYgbWF0Y2guc3RhdHVzICE9PSAnUkFDSU5HJykge1xyXG4gICAgICAgICAgICAgcmV0dXJuIHsgc3RhdHVzOiA0MDAsIGJvZHk6IHsgZXJyb3I6IGBDYW5ub3Qgc3VibWl0LiBNYXRjaCBpcyAke21hdGNoLnN0YXR1c31gIH0gfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGNvbnN0IGpvYkRhdGE6IFJ1bm5lclJlcXVlc3QgPSB7IFxyXG4gICAgICAgICAgICBtYXRjaElkLCBcclxuICAgICAgICAgICAgcGxheWVySWQsIFxyXG4gICAgICAgICAgICBjb2RlLCBcclxuICAgICAgICAgICAgYWN0aW9uOiByZXF1ZXN0VHlwZSxcclxuICAgICAgICAgICAgLy8gQHRzLWlnbm9yZVxyXG4gICAgICAgICAgICBsYW5ndWFnZTogbGFuZ3VhZ2UgfHwgJ3B5dGhvbicsIFxyXG4gICAgICAgICAgICB2ZXJzaW9uOiAnMy4xMC4wJ1xyXG4gICAgICAgIH07XHJcbiAgICAgICAgXHJcbiAgICAgICAgbG9nZ2VyLmluZm8oYEFQSTogUXVldWVpbmcgJHtyZXF1ZXN0VHlwZX0gZm9yICR7cGxheWVySWR9YCk7XHJcbiAgICAgICAgXHJcbiAgICAgICAgYXdhaXQgZW1pdCh7IHRvcGljOiAncnVuLmNvZGUnLCBkYXRhOiBqb2JEYXRhIH0pO1xyXG4gICAgICAgIHJldHVybiB7IHN0YXR1czogMjAwLCBib2R5OiB7IG1zZzogXCJDb2RlIHF1ZXVlZFwiIH0gfTtcclxuICAgIH1cclxuXHJcbiAgICBpZiAoYWN0aW9uID09PSAnYW5hbHl6ZScpIHtcclxuICAgICAgICBjb25zdCB7IGNvZGUsIGxhbmd1YWdlLCBwcm9ibGVtVGl0bGUgfSA9IHJlcS5ib2R5O1xyXG5cclxuICAgICAgICBpZiAoIWNvZGUpIHtcclxuICAgICAgICAgICAgIHJldHVybiB7IHN0YXR1czogNDAwLCBib2R5OiB7IGVycm9yOiBcIk5vIGNvZGUgcHJvdmlkZWQgZm9yIGFuYWx5c2lzLlwiIH0gfTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGF3YWl0IGVtaXQoeyBcclxuICAgICAgICAgICAgdG9waWM6ICdhbmFseXplLmNvZGUnLCBcclxuICAgICAgICAgICAgZGF0YTogeyBcclxuICAgICAgICAgICAgICAgIG1hdGNoSWQsXHJcbiAgICAgICAgICAgICAgICBwbGF5ZXJJZCxcclxuICAgICAgICAgICAgICAgIGNvZGUsXHJcbiAgICAgICAgICAgICAgICBsYW5ndWFnZTogbGFuZ3VhZ2UgfHwgJ3B5dGhvbicsXHJcbiAgICAgICAgICAgICAgICBwcm9ibGVtVGl0bGU6IHByb2JsZW1UaXRsZSB8fCAnVW5rbm93biBQcm9ibGVtJ1xyXG4gICAgICAgICAgICB9IFxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICByZXR1cm4geyBcclxuICAgICAgICAgICAgc3RhdHVzOiAyMDAsIFxyXG4gICAgICAgICAgICBib2R5OiB7IG1zZzogXCJBbmFseXNpcyBzdGFydGVkLiBXYXRjaCB0aGUgc3RyZWFtIGZvciByZXN1bHRzLlwiIH0gXHJcbiAgICAgICAgfTtcclxuICAgIH1cclxuXHJcbiAgICByZXR1cm4geyBzdGF0dXM6IDQwMCwgYm9keTogeyBlcnJvcjogXCJJbnZhbGlkIEFjdGlvblwiIH0gfTtcclxuXHJcbiAgfSBjYXRjaCAoZXJyb3I6IGFueSkge1xyXG4gICAgbG9nZ2VyLmVycm9yKFwiQVBJIEVycm9yXCIsIGVycm9yKTtcclxuICAgIHJldHVybiB7IHN0YXR1czogNTAwLCBib2R5OiB7IGVycm9yOiBlcnJvci5tZXNzYWdlIH0gfTtcclxuICB9XHJcbn07Il0sCiAgIm1hcHBpbmdzIjogIkFBQ0EsU0FBUyxpQkFBaUI7QUFDMUIsU0FBUyxrQkFBa0I7QUFFM0IsT0FBTyxjQUFjO0FBRWQsTUFBTSxTQUFxQjtBQUFBLEVBQ2hDLE1BQU07QUFBQSxFQUNOLE1BQU07QUFBQSxFQUNOLE1BQU07QUFBQSxFQUNOLFFBQVE7QUFBQSxFQUNSLE9BQU8sQ0FBQyxpQkFBaUIsWUFBWSxjQUFjO0FBQUEsRUFDbkQsT0FBTyxDQUFDLGNBQWM7QUFDeEI7QUFFTyxNQUFNLFVBQVUsT0FBTyxLQUFVLFlBQWlCO0FBQ3ZELFFBQU0sRUFBRSxNQUFNLFFBQVEsUUFBUSxJQUFJO0FBQ2xDLFFBQU0sVUFBVTtBQUVoQixNQUFJO0FBSUYsUUFBSSxXQUFXLElBQUk7QUFFbkIsUUFBSSxPQUFPLGFBQWEsVUFBVTtBQUM5QixVQUFJO0FBQ0EsbUJBQVcsS0FBSyxNQUFNLFFBQVE7QUFBQSxNQUNsQyxTQUFT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QyxjQUFhLElBQUksSUFBSTtBQUU3QyxVQUFJLENBQUNGLE9BQU07QUFDTixlQUFPLEVBQUUsUUFBUSxLQUFLLE1BQU0sRUFBRSxPQUFPLGlDQUFpQyxFQUFFO0FBQUEsTUFDN0U7QUFFQSxZQUFNLEtBQUs7QUFBQSxRQUNQLE9BQU87QUFBQSxRQUNQLE1BQU07QUFBQSxVQUNGO0FBQUEsVUFDQTtBQUFBLFVBQ0EsTUFBQUE7QUFBQSxVQUNBLFVBQVVDLGFBQVk7QUFBQSxVQUN0QixjQUFjQyxpQkFBZ0I7QUFBQSxRQUNsQztBQUFBLE1BQ0osQ0FBQztBQUVELGFBQU87QUFBQSxRQUNILFFBQVE7QUFBQSxRQUNSLE1BQU0sRUFBRSxLQUFLLGtEQUFrRDtBQUFBLE1BQ25FO0FBQUEsSUFDSjtBQUVBLFdBQU8sRUFBRSxRQUFRLEtBQUssTUFBTSxFQUFFLE9BQU8saUJBQWlCLEVBQUU7QUFBQSxFQUUxRCxTQUFTLE9BQVk7QUFDbkIsV0FBTyxNQUFNLGFBQWEsS0FBSztBQUMvQixXQUFPLEVBQUUsUUFBUSxLQUFLLE1BQU0sRUFBRSxPQUFPLE1BQU0sUUFBUSxFQUFFO0FBQUEsRUFDdkQ7QUFDRjsiLAogICJuYW1lcyI6IFsiY29kZSIsICJsYW5ndWFnZSIsICJwcm9ibGVtVGl0bGUiXQp9Cg==
